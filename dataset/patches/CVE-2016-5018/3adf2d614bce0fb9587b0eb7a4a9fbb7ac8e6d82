From 3adf2d614bce0fb9587b0eb7a4a9fbb7ac8e6d82 Mon Sep 17 00:00:00 2001
From: Violeta Georgieva Georgieva <violetagg@apache.org>
Date: Mon, 12 Sep 2016 08:17:18 +0000
Subject: [PATCH] Fix https://bz.apache.org/bugzilla/show_bug.cgi?id=60101
 Remove preloading of the class that was deleted.

git-svn-id: https://svn.apache.org/repos/asf/tomcat/tc8.0.x/trunk@1760307 13f79535-47bb-0310-9956-ffa450edef68
---
 java/org/apache/jasper/security/SecurityClassLoad.java | 2 --
 java/org/apache/jasper/servlet/JasperInitializer.java  | 2 --
 webapps/docs/changelog.xml                             | 8 ++++++++
 3 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/java/org/apache/jasper/security/SecurityClassLoad.java b/java/org/apache/jasper/security/SecurityClassLoad.java
index 6890f646b..a9a1d7210 100644
--- a/java/org/apache/jasper/security/SecurityClassLoad.java
+++ b/java/org/apache/jasper/security/SecurityClassLoad.java
@@ -44,8 +44,6 @@ public static void securityClassLoad(ClassLoader loader){
 
             loader.loadClass( basePackage +
                 "runtime.JspRuntimeLibrary");
-            loader.loadClass( basePackage +
-                "runtime.JspRuntimeLibrary$PrivilegedIntrospectHelper");
 
             loader.loadClass( basePackage +
                 "runtime.ServletResponseWrapperInclude");
diff --git a/java/org/apache/jasper/servlet/JasperInitializer.java b/java/org/apache/jasper/servlet/JasperInitializer.java
index 32a85256e..52c3e8aaa 100644
--- a/java/org/apache/jasper/servlet/JasperInitializer.java
+++ b/java/org/apache/jasper/servlet/JasperInitializer.java
@@ -59,8 +59,6 @@ public class JasperInitializer implements ServletContainerInitializer {
                         "runtime.JspFactoryImpl$PrivilegedReleasePageContext");
                 factory.getClass().getClassLoader().loadClass( basePackage +
                         "runtime.JspRuntimeLibrary");
-                factory.getClass().getClassLoader().loadClass( basePackage +
-                        "runtime.JspRuntimeLibrary$PrivilegedIntrospectHelper");
                 factory.getClass().getClassLoader().loadClass( basePackage +
                         "runtime.ServletResponseWrapperInclude");
                 factory.getClass().getClassLoader().loadClass( basePackage +
diff --git a/webapps/docs/changelog.xml b/webapps/docs/changelog.xml
index bcac388e0..04e5de4d3 100644
--- a/webapps/docs/changelog.xml
+++ b/webapps/docs/changelog.xml
@@ -72,6 +72,14 @@
       </add>
     </changelog>
   </subsection>
+  <subsection name="Jasper">
+    <changelog>
+      <fix>
+        <bug>60101</bug>: Remove preloading of the class that was deleted.
+        (violetagg)
+      </fix>
+    </changelog>
+  </subsection>
   <subsection name="Web applications">
     <changelog>
       <add>
